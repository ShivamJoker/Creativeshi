document.addEventListener("DOMContentLoaded", () => {
  const e = document.querySelector("footer"),
    t =
      (document.querySelector(".laptop"),
      ["#3949ab", "#ff0000", "#00aced", "#24292e", "#e4405f"]),
    n =
      (document.querySelector("body"),
      document.querySelector("nav"),
      document.querySelector("#myIntro"),
      document.querySelector("#aboutMeBox")),
    o = document.querySelectorAll(".projectContainer"),
    r = document.querySelector("#projectOpener"),
    c = document.querySelector("span.closeBtn"),
    s = document.querySelector("#embedContent"),
    l = document.querySelectorAll(".loader>span"),
    i = document.querySelector(".loader"),
    a = document.querySelector(".url>.name"),
    d = document.querySelectorAll("#social-links > a");
  d.forEach((n, o) =>
    n.addEventListener("mouseover", () => (e.style.backgroundColor = t[o]))
  ),
    d.forEach((t, n) =>
      t.addEventListener("mouseout", () => (e.style.backgroundColor = ""))
    ),
    d.forEach((e) =>
      e.addEventListener("click", (t) => {
        t.preventDefault(),
          setTimeout(() => {
            let t = e.getAttribute("href");
            window.open(t, "_blank").focus();
          }, 500);
      })
    );
  const u = document.querySelector(".animBox1"),
    m = document.querySelector(".animBox2"),
    y = document.querySelector(".animBox3"),
    p = [u, m, y],
    h = [
      document.querySelector(".animLine1"),
      document.querySelector(".animLine2"),
      document.querySelector(".animLine3"),
    ],
    f = ["rLeftBox", "rCentreBox", "rRightBox"],
    S = ["hSideLine", "hCentreLine", "hSideLine"];
  document.querySelectorAll(".aboutText").forEach((e) => {
    e.addEventListener("click", (e) => {
      let t = e.currentTarget.parentElement;
      function n(e) {
        if (t.classList.contains(e)) {
          let n = document.querySelector(".rCentreBox"),
            o = document.querySelector(`.${e} > .hSideLine`);
          document
            .querySelector(".hCentreLine")
            .classList.replace("hCentreLine", "hSideLine"),
            o.classList.replace("hSideLine", "hCentreLine"),
            n.classList.replace("rCentreBox", e),
            t.classList.replace(e, "rCentreBox");
        }
      }
      n("rLeftBox"), n("rRightBox");
    });
  });
  const g = document.querySelector("#webdev"),
    v = document.querySelector("#design"),
    b = document.querySelector("#electronics");
  let q;
  u.addEventListener("click", () => {
    (g.style.display = "flex"),
      (v.style.display = "none"),
      (b.style.display = "none");
  }),
    m.addEventListener("click", () => {
      (v.style.display = "flex"),
        (g.style.display = "none"),
        (b.style.display = "none");
    }),
    y.addEventListener("click", () => {
      (b.style.display = "flex"),
        (v.style.display = "none"),
        (g.style.display = "none");
    });
  let L,
    T = 1,
    k = 0;
  let E = !1;
  o.forEach((e) => {
    e.addEventListener("click", (e) => {
      E || (N("Click on URL to open"), (E = !0)),
        (r.style.display = "block"),
        (i.style.display = "flex"),
        (function e() {
          q = setInterval(() => {
            l.forEach((e, t) => {
              setTimeout(() => {
                e.classList.add("popUp");
              }, 200 * t),
                setTimeout(() => {
                  e.classList.remove("popUp");
                }, 260 * ++t);
            }),
              setTimeout(() => {
                [...l]
                  .slice()
                  .reverse()
                  .forEach((e, t) => {
                    setTimeout(() => {
                      e.classList.add("popUp");
                    }, 230 * t),
                      setTimeout(() => {
                        e.classList.remove("popUp");
                      }, 280 * ++t);
                  });
              }, 1300),
              1 === T && ((k = 2700), clearInterval(q), e()),
              T++;
          }, k);
        })(),
        (L = "https://creativeshi.com/" + e.currentTarget.id),
        (a.innerHTML = e.currentTarget.id);
      let t = document.createElement("embed");
      t.addEventListener("load", () => {
        clearInterval(q),
          (T = 1),
          (k = 0),
          setTimeout(() => {
            (i.style.display = "none"), (s.style.visibility = "visible");
          }, 1500);
      }),
        setTimeout(() => {
          (t.src = L), s.appendChild(t);
        }, 300),
        document.documentElement.style.setProperty(
          "--clientX",
          e.clientX + "px"
        ),
        document.documentElement.style.setProperty(
          "--clientY",
          e.clientY + "px"
        );
    });
  }),
    a.parentElement.addEventListener("click", () => {
      window.open(L, "_blank").focus();
    }),
    c.addEventListener("click", () => {
      const e = document.querySelector("embed");
      e && e.remove(),
        clearInterval(q),
        (T = 1),
        (k = 0),
        (s.style.visibility = "hidden"),
        (r.style.display = "none");
    }),
    document.documentElement.style.setProperty("--aboutMeRotate", "43deg"),
    document.documentElement.style.setProperty(
      "--screenHeight",
      window.innerHeight + "px"
    );
  const x =
      "Hey! Whatsup guys I am Shivam, A self taught creative guy who loves ❤️ to design and develop creative things and to make people laugh 😀",
    w = document.querySelector("#typingBox");
  let B = 0;
  const C = 25;
  let A;
  var H = {
    rocket: { url: "assets/sounds/rocketFly.mp3" },
    swoosh: { url: "assets/sounds/swoosh.mp3" },
  };
  function M(e) {
    var t = H[e],
      n = t.url,
      o = (t.buffer, new XMLHttpRequest());
    o.open("GET", n, !0),
      (o.responseType = "arraybuffer"),
      (o.onload = function () {
        A.decodeAudioData(o.response, function (e) {
          t.buffer = e;
        });
      }),
      o.send();
  }
  function R(e, t) {
    var n = H[e],
      o = H[e].volume || 1,
      r = n.buffer;
    if (r) {
      var c = A.createBufferSource();
      c.buffer = r;
      var s = A.createGain();
      t ? t.volume && (s.gain.value = o * t.volume) : (s.gain.value = o),
        s.connect(A.destination),
        c.connect(s),
        c.start(0);
    }
  }
  const P = document.querySelector("#enterBtn"),
    F = document.querySelector("#mainContent"),
    I = (document.querySelector("#intro"), document.querySelector("#intro1")),
    j = document.querySelector("#intro2"),
    z = document.querySelector("main"),
    $ = document.querySelector("#pageLoader"),
    U = document.querySelector("#message");
  function N(e) {
    setTimeout(() => {
      (U.innerHTML = e),
        (U.style.right = "-40px"),
        setTimeout(() => {
          U.style.right = "";
        }, 3e3);
    }, 700);
  }
  let D = !1,
    O = !1,
    Y = !1,
    J = !1,
    X = 0;
  const _ = document.querySelector("#learned"),
    G = document.querySelector("#myProjects"),
    V = document.querySelector(".overlay");
  function W(e) {
    let t = z.scrollTop;
    const n = e.offsetTop,
      o = e.offsetHeight;
    return t > n - 300 && t < o + n - 300;
  }
  function Z() {
    var e;
    !(function () {
      for (var e in ((A = new (window.AudioContext ||
        window.webkitAudioContext)()),
      H))
        M(e);
    })(),
      ($.style.display = "none"),
      (F.style.display = "block"),
      (function () {
        var e = document.getElementById("smoke"),
          t = e.getContext("2d");
        (e.width = 1e3), (e.height = 1e3);
        var n = smokemachine(t, [255, 255, 255]);
        setTimeout(function () {
          n.addsmoke(500, 720, 10),
            n.addsmoke(500, 900, 20),
            n.addsmoke(450, 900, 20),
            n.addsmoke(550, 900, 20);
          for (var e = 0; e < 10; e++) n.step(10);
          n.start();
        }, 2e3);
      })(),
      A.resume(),
      setTimeout(() => {
        R("rocket");
      }, 4300),
      setTimeout(() => {
        R("swoosh");
      }, 12300),
      R("swoosh"),
      setTimeout(() => {
        I.remove(),
          j.classList.add("intro2Anim"),
          setTimeout(() => {
            e = setInterval(function () {
              B == x.length
                ? (this.clearTimeout(e),
                  (w.innerHTML = x + '<span id="blinki">|</span>'))
                : ((document.querySelector("#typingBox").innerHTML =
                    x.slice(0, B + 1) + "|"),
                  B++);
            }, 1e3 / C);
          }, 1e3),
          setTimeout(() => {
            (n.style.display = "block"),
              z.scrollTo({ top: window.innerHeight, behavior: "smooth" });
          }, 8e3);
      }, 12700);
  }
  "feedback=true" === document.cookie && V.remove(),
    z.addEventListener("scroll", () => {
      if (!D && W(n)) {
        (document.getElementById("aboutMePlayer").style.display = "flex"),
          (D = !0);
      }
      if (
        (O ||
          (W(_) &&
            (h.forEach((e, t) => {
              e.classList.add(S[t]),
                setTimeout(() => {
                  e.style.transitionTimingFunction = "ease";
                }, 1e3);
            }),
            setTimeout(() => {
              p.forEach((e, t) => {
                e.classList.add(f[t]),
                  setTimeout(() => {
                    e.style.transitionTimingFunction = "ease";
                  }, 1e3);
              });
            }, 550),
            N("Touch The Balls"),
            (O = !0))),
        !J && W(G))
      ) {
        for (let e = 0; e < o.length; e++)
          setTimeout(() => {
            o[e].classList.add("projectPop");
          }, X),
            (X += 200);
        N("Click To Preview"), (J = !0);
      }
      const e = document.querySelector(".bottomSection");
      Y ||
        (W(e) &&
          (grecaptcha.ready(function () {
            grecaptcha
              .execute("6Le1toEUAAAAAITyNwqEMaz3hFAYzciSJDMomrgN", {})
              .then(function (e) {
                (re = e), document.querySelector(".grecaptcha-badge").remove();
              });
          }),
          console.log("Recaptcha excuted"),
          setTimeout(() => {
            V.style.display = "flex";
          }, 3e3),
          (Y = !0)));
    });
  const K = document.querySelector("#myFriends");
  let Q;
  const githubUsernames = ["ashishpandey001", "bushblade", "codersgyan",];
  ee.forEach((e, t) => {
    ((e) => {
      let t = "https://api.github.com/users/" + ee[e];
      fetch(t)
        .then((e) => e.json())
        .then((e) => {
          (Q = `<a href='${e.blog}'><div><img src='${e.avatar_url}&s=200' alt='${e.name}'>\n                            <h2>${e.name}</div></h2></a>`),
            (K.innerHTML += Q);
        });
    })(t);
  }),
    P.addEventListener("click", () => {
      if (window.innerHeight < 630) {
        var e = document.documentElement;
        (
          e.requestFullscreen ||
          e.webkitRequestFullScreen ||
          e.mozRequestFullScreen ||
          e.msRequestFullscreen
        ).call(e);
      }
      setTimeout(() => {
        document.documentElement.style.setProperty(
          "--screenHeight",
          window.innerHeight + "px"
        ),
          P.parentElement.remove();
      }, 500),
        Z();
    }),
    (document.onreadystatechange = function () {
      "complete" === document.readyState && (P.style.display = "block");
    });
  const te = document.querySelector("form"),
    ne = document.querySelector("#status"),
    oe = document.querySelector("form>button");
  let re;
  (/constructor/i.test(window.HTMLElement) ||
    "[object SafariRemoteNotification]" ===
      (
        !window.safari ||
        ("undefined" != typeof safari && safari.pushNotification)
      ).toString()) &&
    (te.elements.message.setAttribute(
      "placeholder",
      "Please switch to another browser Safari can't send message!"
    ),
    te.elements.name.setAttribute("disabled", !0),
    te.elements.email.setAttribute("disabled", !0),
    te.elements.message.setAttribute("disabled", !0));
  const ce = (e) => {
    const t = {
      method: "POST",
      body: JSON.stringify(e),
      headers: new Headers({ "Content-Type": "application/json" }),
    };
    return fetch("https://xmailerr.glitch.me/contact", t)
      .then((e) => e.json())
      .then((e) =>
        ((e) => {
          (ne.innerHTML = e.status),
            (ne.style.display = "block"),
            (oe.innerHTML = "Send"),
            te.reset(),
            setTimeout(() => {
              ne.style.display = "none";
            }, 3e3);
        })(e)
      )
      .catch((e) => console.log(e));
  };
  te.addEventListener("submit", (e) => {
    e.preventDefault(), (oe.innerHTML = "Sending...");
    let t = {
      name: te.elements.name.value,
      email: te.elements.email.value,
      message: te.elements.message.value,
      captcha: re,
    };
    ce(t);
  });
  const se = document.querySelectorAll(".rating > label"),
    le = document.getElementById("emotion"),
    ie = document.querySelector(".sendBtn"),
    ae = document.querySelector(".currentRating"),
    de = document.querySelector("#feedback"),
    ue = document.querySelector(".userFeedbackBox");
  let me, ye, pe;
  document.cookie,
    se.forEach((e, t) => {
      e.addEventListener("mouseover", () => {
        if (t > 2) {
          const e =
            "M181.349,373.317c17.079-18.563,44.986-29.646,74.651-29.646s57.572,11.083,74.651,29.646  c1.479,1.607,3.497,2.422,5.521,2.422c1.815,0,3.635-0.655,5.076-1.981c3.048-2.804,3.246-7.549,0.441-10.597  c-19.87-21.596-51.904-34.49-85.689-34.49s-65.82,12.894-85.689,34.49c-2.804,3.048-2.607,7.793,0.441,10.597  C173.8,376.563,178.544,376.365,181.349,373.317z";
          le.setAttribute("d", e);
        } else if (2 === t) {
          const e = "M250.281,368.975H114.092V347.647h267.3v21.328Z";
          le.setAttribute("d", e);
        } else {
          const e =
            "M256,420.544c-74.864,0-140.096-50.704-158.624-123.28c-1.456-5.712,1.984-11.52,7.696-12.976  c5.68-1.488,11.504,1.984,12.96,7.696c16.128,63.136,72.848,107.232,137.952,107.232s121.84-44.096,137.952-107.232  c1.44-5.712,7.248-9.184,12.976-7.696c5.712,1.456,9.152,7.264,7.696,12.976C396.096,369.84,330.864,420.544,256,420.544z";
          le.setAttribute("d", e);
        }
      });
    }),
    ie.addEventListener("click", () => {
      !(function () {
        const e = document.querySelector("input[name ='rating']:checked");
        void 0 == e
          ? alert("Please select any star to rate it")
          : ((me = e.value),
            (ye = de.value),
            (pe = { feedback: ye, rating: me }),
            console.log(pe),
            (function () {
              (he.textContent = "Sending "),
                (fe.style.display = "inline-block"),
                (Se.style.display = "none"),
                he.classList.add("displayNone");
              const e = {
                method: "PUT",
                body: JSON.stringify(pe),
                headers: new Headers({ "Content-Type": "application/json" }),
              };
              fetch(ge, e)
                .then((e) => e.json())
                .then((e) => {
                  ae.textContent = e;
                  const t = document.querySelector(".feedbackResponse");
                  (t.style.display = "block"),
                    (document.cookie =
                      "feedback=true; expires=Thu, 18 Dec 2022 12:00:00 UTC"),
                    Le(),
                    setTimeout(() => {
                      const e = document.querySelector(".getFeedback");
                      e.style.top = 0;
                    }, 100);
                })
                .catch((e) => console.log(e));
            })());
      })();
    });
  const he = document.querySelector(".sendBtn > .sendSpan"),
    fe = document.querySelector(".spinningArrow"),
    Se = document.querySelector(".forwardArrow");
  const ge = "https://xmailerr.glitch.me/feedback";
  let ve,
    be = 0,
    qe = 1e3;
  function Le() {
    fetch(`${ge}?loaded=${be}`)
      .then((e) => e.json())
      .then((e) => {
        console.log(e),
          (be += (ve = e).length),
          ve.forEach((e) => {
            const t = `<div class="singleRatingBox">\n            <span class="ratingScore">${e.rating}</span>\n            <div class="userFeedback">\n                ${e.message}\n            </div>\n            </div>`;
            ue.innerHTML += t;
          }),
          ue.scrollTo({ top: qe, behavior: "smooth" }),
          (qe += 1e3),
          setTimeout(() => {
            !(function () {
              const e = document.querySelectorAll(".singleRatingBox"),
                t = e.length;
              for (let n = 0 + ke; n < t; n++)
                (e[n].style.zIndex = t + ke - n),
                  setTimeout(() => {
                    e[n].classList.add("slideRatingBox");
                  }, Te),
                  (Te += 250),
                  n === 4 + ke && ((Te = 0), (ke = t));
            })();
          }, 100);
      })
      .catch((e) => console.log(e));
  }
  document.querySelector(".loadMoreBtn").addEventListener("click", () => {
    Le();
  });
  let Te = 250,
    ke = 0;
  const Ee = document.querySelector(".feedbackCloseBtn");
  Ee.addEventListener("click", () => {
    (Ee.parentElement.style.transform = "translateY(120%)"),
      (Ee.parentElement.parentElement.style.opacity = "0"),
      setTimeout(() => {
        Ee.parentElement.parentElement.remove();
      }, 500);
  });
});
